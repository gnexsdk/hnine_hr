{% extends "base.html" %}

{% block title %}HINE - ë¶€ê³  ë©”ì¼ ë°œì†¡{% endblock %}
{% block page_title %}ë¶€ê³  ë©”ì¼ ë°œì†¡{% endblock %}

{% block content %}
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
    <!-- Form Section -->
    <div class="card">
        <div class="card-header">
            <h3>âœ‰ï¸ ë¶€ê³  ì •ë³´ ì…ë ¥</h3>
        </div>
        <div class="card-body">
            <form name="ripForm" method="post" enctype="multipart/form-data" onsubmit="return validateForm()">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                    <div class="form-group">
                        <label>íŒ€/ì‹¤</label>
                        <input type="text" name="team" value="{{ form_data.team }}" required placeholder="ì˜ˆ: Visualì‹¤">
                    </div>
                    <div class="form-group">
                        <label>ì´ë¦„</label>
                        <input type="text" name="name" value="{{ form_data.name }}" required placeholder="ì§ì› ì´ë¦„">
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                    <div class="form-group">
                        <label>ê´€ê³„</label>
                        <input type="text" name="relation" value="{{ form_data.relation }}" required placeholder="ì˜ˆ: ì¡°ë¶€">
                    </div>
                    <div class="form-group">
                        <label>ê³ ì¸ëª…</label>
                        <input type="text" name="deceased" value="{{ form_data.deceased }}" required placeholder="ê³ ì¸ ì„±í•¨">
                    </div>
                </div>

                <div class="form-group">
                    <label>ë³„ì„¸ì¼</label>
                    <input type="text" name="date" value="{{ form_data.date }}" required placeholder="2024ë…„ 9ì›” 26ì¼ ëª©ìš”ì¼">
                </div>

                <div class="form-group">
                    <label>ë¹ˆì†Œ</label>
                    <input type="text" name="funeral_home" value="{{ form_data.funeral_home }}" required placeholder="ì¥ë¡€ì‹ì¥ ì´ë¦„">
                </div>

                <div class="form-group">
                    <label>ì£¼ì†Œ</label>
                    <input type="text" name="address" value="{{ form_data.address }}" required placeholder="ì¥ë¡€ì‹ì¥ ì£¼ì†Œ">
                </div>

                <div class="form-group">
                    <label>ë°œì¸</label>
                    <input type="text" name="final_date" value="{{ form_data.final_date }}" required placeholder="2024ë…„ 9ì›” 28ì¼ í† ìš”ì¼ ì˜¤ì „ 6ì‹œ00ë¶„">
                </div>

                <div class="form-group">
                    <label>ë¶€ê³  ê´€ë ¨ URL <span style="font-weight: 400; color: var(--slate-400);">(ì„ íƒì‚¬í•­)</span></label>
                    <input type="url" name="url" value="{{ form_data.url }}" placeholder="https://example.com">
                </div>

                <div style="display: flex; gap: 12px; margin-top: 24px; flex-wrap: wrap;">
                    <button type="submit" class="btn btn-secondary" id="preview-btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                        ë¯¸ë¦¬ë³´ê¸°
                    </button>
                    <button type="submit" name="send" value="test" class="btn btn-primary">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="22" y1="2" x2="11" y2="13"></line>
                            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                        </svg>
                        í…ŒìŠ¤íŠ¸ ë©”ì¼ ë°œì†¡
                    </button>
                    <button type="submit" name="send" value="all" class="btn btn-danger">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                            <polyline points="22,6 12,13 2,6"></polyline>
                        </svg>
                        ì „ì²´ ë©”ì¼ ë°œì†¡
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Preview Section -->
    <div class="card">
        <div class="card-header">
            <h3>ğŸ‘ï¸ ë¯¸ë¦¬ë³´ê¸°</h3>
        </div>
        <div class="card-body" style="display: flex; align-items: center; justify-content: center; min-height: 400px;">
            {% if preview_image %}
            <img src="data:image/png;base64,{{ preview_image }}" style="max-width: 100%; border-radius: 8px; box-shadow: var(--shadow-md);">
            {% else %}
            <div style="text-align: center; color: var(--slate-400);">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 16px;">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <polyline points="21 15 16 10 5 21"></polyline>
                </svg>
                <p style="font-size: 14px; font-weight: 500;">ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</p>
                <p style="font-size: 12px; margin-top: 4px;">ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  ë¯¸ë¦¬ë³´ê¸°ë¥¼ í´ë¦­í•˜ì„¸ìš”</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<script>
    function validateForm() {
        var requiredFields = [
            'team', 'name', 'relation', 'deceased',
            'date', 'funeral_home', 'address', 'final_date'
        ];

        for (var field of requiredFields) {
            if (!document.forms["ripForm"][field].value) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return false;
            }
        }

        var submitButton = document.activeElement;
        if (submitButton.name === 'send' && submitButton.value === 'all') {
            return confirm('ì „ì²´ êµ¬ì„±ì›ì—ê²Œ ë©”ì¼ì„ ë°œì†¡í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
        }

        return true;
    }
</script>
{% endblock %}

{% block extra_styles %}
<style>
    @media (max-width: 768px) {
        div[style*="grid-template-columns: 1fr 1fr"] {
            grid-template-columns: 1fr !important;
        }
    }
</style>
{% endblock %}
